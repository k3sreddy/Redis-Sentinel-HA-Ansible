# {{ ansible_managed }}
# Redis Sentinel Configuration
# Generated by Ansible on {{ ansible_date_time.iso8601 }}

# Basic configuration
port {{ sentinel_port }}
bind {{ ansible_default_ipv4.address }} 127.0.0.1

# Logging
logfile /var/log/redis/sentinel.log
loglevel notice

# Sentinel configuration
sentinel announce-ip {{ ansible_default_ipv4.address }}
sentinel announce-port {{ sentinel_port }}

# Monitor master
sentinel monitor {{ sentinel_master_name }} {{ hostvars[groups['redis_master'][0]]['ansible_default_ipv4']['address'] }} {{ redis_port }} {{ sentinel_quorum }}

# Authentication
sentinel auth-pass {{ sentinel_master_name }} {{ redis_password }}

# Timeouts and failover configuration
sentinel down-after-milliseconds {{ sentinel_master_name }} {{ sentinel_down_after_ms }}
sentinel failover-timeout {{ sentinel_master_name }} {{ sentinel_failover_timeout_ms }}
sentinel parallel-syncs {{ sentinel_master_name }} {{ sentinel_parallel_syncs }}

# Notification script (optional)
# sentinel notification-script {{ sentinel_master_name }} /path/to/notify.sh

# Client reconfig script (optional) 
# sentinel client-reconfig-script {{ sentinel_master_name }} /path/to/reconfig.sh

# Additional security
protected-mode yes

# Deny dangerous commands
sentinel deny-scripts-reconfig yes

# Resolve hostnames
sentinel resolve-hostnames yes
